unique_name: dim_time_dataset
object_type: dataset
label: dim_time_dataset
columns:
  - name: NAME
    data_type: string
  - name: PK_DATE
    data_type: datetime
  - name: DATEKEY
    data_type: int
  - name: DATE_NAME
    data_type: string
  - name: YEAR
    data_type: string
  - name: YEAR_NAME
    data_type: string
  - name: HALF_YEAR
    data_type: date
  - name: HALF_YEAR_NAME
    data_type: string
  - name: QUARTER
    data_type: date
  - name: QUARTER_NAME
    data_type: string
  - name: MONTH
    data_type: date
  - name: MONTH_NAME
    data_type: string
  - name: WEEK
    data_type: date
  - name: WEEK_NAME
    data_type: string
  - name: DAY_OF_YEAR
    data_type: int
  - name: DAY_OF_YEAR_NAME
    data_type: string
  - name: DAY_OF_WEEK
    data_type: int
  - name: DAY_OF_WEEK_NAME
    data_type: string
  - name: WEEK_OF_YEAR
    data_type: int
  - name: WEEK_OF_YEAR_NAME
    data_type: string
  - name: MONTH_OF_YEAR
    data_type: int
  - name: MONTH_OF_YEAR_NAME
    data_type: string
  - name: QUARTER_OF_YEAR
    data_type: int
  - name: QUARTER_OF_YEAR_NAME
    data_type: string
connection_id: dbt_connection_BigQuery
sql: >-
  SELECT TIMESTAMP(date_day) as pk_date, cast(FORMAT_DATE("%Y%m%d", date_day) as
  decimal) as datekey, FORMAT_DATE('%A, %B %d, %Y', date_day) as date_name,
  CAST(EXTRACT(YEAR from date_day) AS STRING) as year, concat("Calendar
  ",FORMAT_DATE('%Y', date_day)) as year_name, IF(EXTRACT(QUARTER FROM date_day)
  < 3, DATE_TRUNC(date_day,YEAR), DATE_ADD(DATE_TRUNC(date_day,YEAR), INTERVAL 2
  QUARTER)) as half_year, IF(EXTRACT(QUARTER FROM date_day) < 3,
  concat("Semester 1, ",FORMAT_DATE('%Y', date_day)), concat("Semester 2, ",
  FORMAT_DATE('%Y', date_day))) as half_year_name, DATE_TRUNC(date_day, QUARTER)
  as quarter, FORMAT_DATE('Quarter %Q, %Y', date_day) as quarter_name,
  DATE_TRUNC(date_day, MONTH) as month, FORMAT_DATE('%B %Y', date_day) as
  month_name, DATE_TRUNC(date_day, WEEK) as week, concat("Week ", EXTRACT(WEEK
  from date_day), FORMAT_DATE(', %Y', date_day)) as week_name, EXTRACT(DAYOFYEAR
  from date_day) as day_of_year, concat("Day ", EXTRACT(DAYOFYEAR from
  date_day)) as day_of_year_name, EXTRACT(DAYOFWEEK from date_day) as
  day_of_week, FORMAT_DATE('%a', date_day) as day_of_week_name, EXTRACT(WEEK
  from date_day) as week_of_year, concat("Week ", EXTRACT(WEEK from date_day))
  as week_of_year_name, EXTRACT(MONTH from date_day) as month_of_year,
  FORMAT_DATE('%B', date_day) as month_of_year_name, EXTRACT(QUARTER from
  date_day) as quarter_of_year, concat("Quarter ", EXTRACT(QUARTER from
  date_day)) as quarter_of_year_name    FROM DBT_DWOOD.metricflow_time_spine
