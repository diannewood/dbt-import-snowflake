unique_name: order_items_dataset
object_type: dataset
label: order_items_dataset
columns:
  - name: order_item
    data_type: string
    sql: order_item_id
  - name: order_id
    data_type: string
  - name: product
    data_type: string
    sql: product_id
  - name: ordered_at
    data_type: datetime
    sql: cast(ordered_at as DATETIME)
  - name: is_food_item
    data_type: boolean
  - name: is_drink_item
    data_type: boolean
  - name: revenue
    data_type: double
    sql: product_price
  - name: food_revenue
    data_type: double
    sql: case when is_food_item = 1 then product_price else 0 end
  - name: drink_revenue
    data_type: double
    sql: case when is_drink_item = 1 then product_price else 0 end
  - name: median_revenue
    data_type: double
    sql: product_price
connection_id: dbt_connection_con1
table: order_items
