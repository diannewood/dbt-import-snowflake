{
    "_connections": [
        {
            "unique_name": "dbt_connection_BigQuery",
            "object_type": "connection",
            "label": "DBT bigquery Connection BigQuery",
            "database": "atscale-data-warehouse",
            "schema": "dbt_dwood",
            "as_connection": "BigQuery"
        }
    ],
    "_models": [
        {
            "label": "jaffle_shop",
            "relationships": [
                {
                    "unique_name": "orders_dataset_Dim_stg_locations",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "location"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_stg_locations",
                        "level": "location"
                    }
                },
                {
                    "unique_name": "orders_dataset_Dim_customers",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "customer"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_customers",
                        "level": "customer"
                    }
                },
                {
                    "unique_name": "order_items_dataset_Dim_orders",
                    "from": {
                        "dataset": "order_items_dataset",
                        "join_columns": [
                            "order_id"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_orders",
                        "level": "order_id"
                    }
                },
                {
                    "unique_name": "order_items_dataset_Dim_stg_products",
                    "from": {
                        "dataset": "order_items_dataset",
                        "join_columns": [
                            "product"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_stg_products",
                        "level": "product"
                    }
                },
                {
                    "unique_name": "stg_locations_dataset_Dim_stg_locations",
                    "from": {
                        "dataset": "stg_locations_dataset",
                        "join_columns": [
                            "location"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_stg_locations",
                        "level": "location"
                    }
                },
                {
                    "unique_name": "customers_dataset_Dim_customers",
                    "from": {
                        "dataset": "customers_dataset",
                        "join_columns": [
                            "customer"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_customers",
                        "level": "customer"
                    }
                },
                {
                    "unique_name": "orders_dataset_Dim_orders",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "order_id"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_orders",
                        "level": "order_id"
                    }
                },
                {
                    "unique_name": "orders_dataset_Date Dimension_ordered_at",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "ordered_at"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "ordered_at {0}"
                },
                {
                    "unique_name": "orders_dataset_Date Dimension_ordered_at_test",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "ordered_at_test"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "ordered_at_test {0}"
                },
                {
                    "unique_name": "order_items_dataset_Date Dimension_ordered_at",
                    "from": {
                        "dataset": "order_items_dataset",
                        "join_columns": [
                            "ordered_at"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "ordered_at {0}"
                },
                {
                    "unique_name": "customers_dataset_Date Dimension_first_ordered_at",
                    "from": {
                        "dataset": "customers_dataset",
                        "join_columns": [
                            "first_ordered_at"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "first_ordered_at {0}"
                },
                {
                    "unique_name": "customers_dataset_Date Dimension_last_ordered_at",
                    "from": {
                        "dataset": "customers_dataset",
                        "join_columns": [
                            "last_ordered_at"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "last_ordered_at {0}"
                },
                {
                    "unique_name": "stg_locations_dataset_Date Dimension_opened_at",
                    "from": {
                        "dataset": "stg_locations_dataset",
                        "join_columns": [
                            "opened_at"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "opened_at {0}"
                }
            ],
            "metrics": [
                {
                    "unique_name": "order_total",
                    "folder": "Orders"
                },
                {
                    "unique_name": "order_count",
                    "folder": "Orders"
                },
                {
                    "unique_name": "tax_paid",
                    "folder": "Orders"
                },
                {
                    "unique_name": "customers_with_orders",
                    "folder": "Orders"
                },
                {
                    "unique_name": "locations_with_orders",
                    "folder": "Orders"
                },
                {
                    "unique_name": "order_cost",
                    "folder": "Orders"
                },
                {
                    "unique_name": "revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "food_revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "drink_revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "median_revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "count_lifetime_orders",
                    "folder": "Customers"
                },
                {
                    "unique_name": "lifetime_spend_pretax",
                    "folder": "Customers"
                },
                {
                    "unique_name": "lifetime_spend",
                    "folder": "Customers"
                },
                {
                    "unique_name": "average_tax_rate",
                    "folder": "Stg_locations"
                },
                {
                    "unique_name": "orders",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "orders_fill_nulls_with_zero",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "twice_orders_fill_nulls_with_0",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "revenue_fill_nulls",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "food_revenue_pct",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "revenue_prev_month",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "revenue_growth_mom",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "order_gross_profit",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "cumulative_revenue",
                    "folder": "Other Calculations"
                }
            ],
            "object_type": "model",
            "unique_name": "jaffle_shop",
            "dimensions": [
                "Dim_order_total_dim",
                "Dim_is_food_order",
                "Dim_is_drink_order",
                "Dim_is_food_item",
                "Dim_is_drink_item",
                "Dim_customer_name",
                "Dim_customer_type",
                "Dim_location_name"
            ]
        }
    ],
    "_datasets": [
        {
            "object_type": "dataset",
            "unique_name": "orders_dataset",
            "label": "orders_dataset",
            "columns": [
                {
                    "name": "order_id",
                    "data_type": "string"
                },
                {
                    "name": "location",
                    "data_type": "string",
                    "sql": "location_id"
                },
                {
                    "name": "customer",
                    "data_type": "string",
                    "sql": "customer_id"
                },
                {
                    "name": "ordered_at",
                    "data_type": "datetime"
                },
                {
                    "name": "ordered_at_test",
                    "data_type": "datetime",
                    "sql": "ordered_at"
                },
                {
                    "name": "order_total_dim",
                    "data_type": "string",
                    "sql": "order_total"
                },
                {
                    "name": "is_food_order",
                    "data_type": "boolean"
                },
                {
                    "name": "is_drink_order",
                    "data_type": "boolean"
                },
                {
                    "name": "order_total",
                    "data_type": "decimal"
                },
                {
                    "name": "order_count",
                    "data_type": "long",
                    "sql": "1"
                },
                {
                    "name": "tax_paid",
                    "data_type": "decimal"
                },
                {
                    "name": "customers_with_orders",
                    "data_type": "string",
                    "sql": "customer_id"
                },
                {
                    "name": "locations_with_orders",
                    "data_type": "string",
                    "sql": "location_id"
                },
                {
                    "name": "order_cost",
                    "data_type": "decimal"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "orders",
            "description": "Order overview data mart, offering key details for each order inlcluding if it's a customer's first order and a food vs. drink item breakdown. One row per order."
        },
        {
            "object_type": "dataset",
            "unique_name": "order_items_dataset",
            "label": "order_items_dataset",
            "columns": [
                {
                    "name": "order_item",
                    "data_type": "string",
                    "sql": "order_item_id"
                },
                {
                    "name": "order_id",
                    "data_type": "string"
                },
                {
                    "name": "product",
                    "data_type": "string",
                    "sql": "product_id"
                },
                {
                    "name": "ordered_at",
                    "data_type": "datetime"
                },
                {
                    "name": "is_food_item",
                    "data_type": "boolean"
                },
                {
                    "name": "is_drink_item",
                    "data_type": "boolean"
                },
                {
                    "name": "revenue",
                    "data_type": "decimal",
                    "sql": "product_price"
                },
                {
                    "name": "food_revenue",
                    "data_type": "decimal",
                    "sql": "case when is_food_item = 1 then product_price else 0 end"
                },
                {
                    "name": "drink_revenue",
                    "data_type": "decimal",
                    "sql": "case when is_drink_item = 1 then product_price else 0 end"
                },
                {
                    "name": "median_revenue",
                    "data_type": "decimal",
                    "sql": "product_price"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "order_items"
        },
        {
            "object_type": "dataset",
            "unique_name": "customers_dataset",
            "label": "customers_dataset",
            "columns": [
                {
                    "name": "customer",
                    "data_type": "string",
                    "sql": "customer_id"
                },
                {
                    "name": "customer_name",
                    "data_type": "string"
                },
                {
                    "name": "customer_type",
                    "data_type": "string"
                },
                {
                    "name": "first_ordered_at",
                    "data_type": "datetime"
                },
                {
                    "name": "last_ordered_at",
                    "data_type": "datetime"
                },
                {
                    "name": "count_lifetime_orders",
                    "data_type": "long"
                },
                {
                    "name": "lifetime_spend_pretax",
                    "data_type": "decimal"
                },
                {
                    "name": "lifetime_spend",
                    "data_type": "decimal"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "customers",
            "description": "Customer overview data mart, offering key details for each unique customer. One row per customer."
        },
        {
            "object_type": "dataset",
            "unique_name": "stg_locations_dataset",
            "label": "stg_locations_dataset",
            "columns": [
                {
                    "name": "location",
                    "data_type": "string",
                    "sql": "location_id"
                },
                {
                    "name": "location_name",
                    "data_type": "string"
                },
                {
                    "name": "opened_at",
                    "data_type": "datetime"
                },
                {
                    "name": "average_tax_rate",
                    "data_type": "decimal",
                    "sql": "tax_rate"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "stg_locations",
            "description": "List of open locations with basic cleaning and transformation applied, one row per location."
        },
        {
            "object_type": "dataset",
            "unique_name": "stg_products_dataset",
            "label": "stg_products_dataset",
            "columns": [
                {
                    "name": "product",
                    "data_type": "string",
                    "sql": "product_id"
                },
                {
                    "name": "product_name",
                    "data_type": "string"
                },
                {
                    "name": "product_type",
                    "data_type": "string"
                },
                {
                    "name": "product_description",
                    "data_type": "string"
                },
                {
                    "name": "is_food_item",
                    "data_type": "boolean"
                },
                {
                    "name": "is_drink_item",
                    "data_type": "boolean"
                },
                {
                    "name": "product_price",
                    "data_type": "string"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "stg_products",
            "description": "Product (food and drink items that can be ordered) data with basic cleaning and transformation applied, one row per product."
        },
        {
            "object_type": "dataset",
            "unique_name": "dim_time_dataset",
            "label": "dim_time_dataset",
            "columns": [
                {
                    "name": "name",
                    "data_type": "string"
                },
                {
                    "name": "pk_date",
                    "data_type": "datetime"
                },
                {
                    "name": "datekey",
                    "data_type": "int"
                },
                {
                    "name": "date_name",
                    "data_type": "string"
                },
                {
                    "name": "year",
                    "data_type": "string"
                },
                {
                    "name": "year_name",
                    "data_type": "string"
                },
                {
                    "name": "half_year",
                    "data_type": "date"
                },
                {
                    "name": "half_year_name",
                    "data_type": "string"
                },
                {
                    "name": "quarter",
                    "data_type": "date"
                },
                {
                    "name": "quarter_name",
                    "data_type": "string"
                },
                {
                    "name": "month",
                    "data_type": "date"
                },
                {
                    "name": "month_name",
                    "data_type": "string"
                },
                {
                    "name": "week",
                    "data_type": "date"
                },
                {
                    "name": "week_name",
                    "data_type": "string"
                },
                {
                    "name": "day_of_year",
                    "data_type": "int"
                },
                {
                    "name": "day_of_year_name",
                    "data_type": "string"
                },
                {
                    "name": "day_of_week",
                    "data_type": "int"
                },
                {
                    "name": "day_of_week_name",
                    "data_type": "string"
                },
                {
                    "name": "week_of_year",
                    "data_type": "int"
                },
                {
                    "name": "week_of_year_name",
                    "data_type": "string"
                },
                {
                    "name": "month_of_year",
                    "data_type": "int"
                },
                {
                    "name": "month_of_year_name",
                    "data_type": "string"
                },
                {
                    "name": "quarter_of_year",
                    "data_type": "int"
                },
                {
                    "name": "quarter_of_year_name",
                    "data_type": "string"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "sql": "SELECT TIMESTAMP(date_day) as pk_date,\n        cast(FORMAT_DATE(\"%Y%m%d\", date_day) as decimal) as datekey,\n        FORMAT_DATE('%A, %B %d, %Y', date_day) as date_name,\n        CAST(EXTRACT(YEAR from date_day) AS STRING) as year,\n        concat(\"Calendar \",FORMAT_DATE('%Y', date_day)) as year_name,\n        IF(EXTRACT(QUARTER FROM date_day) < 3, DATE_TRUNC(date_day,YEAR), DATE_ADD(DATE_TRUNC(date_day,YEAR), INTERVAL 2 QUARTER)) as half_year,\n        IF(EXTRACT(QUARTER FROM date_day) < 3, concat(\"Semester 1, \",FORMAT_DATE('%Y', date_day)), concat(\"Semester 2, \", FORMAT_DATE('%Y', date_day))) as half_year_name,\n        DATE_TRUNC(date_day, QUARTER) as quarter,\n        FORMAT_DATE('Quarter %Q, %Y', date_day) as quarter_name,\n        DATE_TRUNC(date_day, MONTH) as month,\n        FORMAT_DATE('%B %Y', date_day) as month_name,\n        DATE_TRUNC(date_day, WEEK) as week,\n        concat(\"Week \", EXTRACT(WEEK from date_day), FORMAT_DATE(', %Y', date_day)) as week_name,\n        EXTRACT(DAYOFYEAR from date_day) as day_of_year,\n        concat(\"Day \", EXTRACT(DAYOFYEAR from date_day)) as day_of_year_name,\n        EXTRACT(DAYOFWEEK from date_day) as day_of_week,\n        FORMAT_DATE('%a', date_day) as day_of_week_name,\n        EXTRACT(WEEK from date_day) as week_of_year,\n        concat(\"Week \", EXTRACT(WEEK from date_day)) as week_of_year_name,\n        EXTRACT(MONTH from date_day) as month_of_year,\n        FORMAT_DATE('%B', date_day) as month_of_year_name,\n        EXTRACT(QUARTER from date_day) as quarter_of_year,\n        concat(\"Quarter \", EXTRACT(QUARTER from date_day)) as quarter_of_year_name\n        FROM dbt_dwood.metricflow_time_spine"
        }
    ],
    "_dimensions": [
        {
            "level_attributes": [
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "year"
                    ],
                    "label": "Year",
                    "name_column": "year_name",
                    "unique_name": "YearMonth",
                    "description": "Year level of the Standard Calendar Month Hierarchy"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "quarter"
                    ],
                    "label": "Quarter",
                    "name_column": "quarter_name",
                    "unique_name": "Quarter",
                    "sort_column": "quarter"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "month"
                    ],
                    "label": "Month",
                    "name_column": "month_name",
                    "unique_name": "Month1",
                    "sort_column": "month"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "pk_date"
                    ],
                    "label": "Day",
                    "name_column": "date_name",
                    "unique_name": "DayMonth",
                    "description": "Day level of standard calendar Month Hierarchy",
                    "is_unique_key": true,
                    "sort_column": "pk_date",
                    "allowed_calcs_for_dma": [
                        "Siblings",
                        "ParallelPeriod",
                        "Ancestor",
                        "Descendants",
                        "PeriodsToDate"
                    ]
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "year"
                    ],
                    "label": "Year",
                    "name_column": "year_name",
                    "unique_name": "YearWeek",
                    "sort_column": "year"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "week"
                    ],
                    "label": "Week",
                    "name_column": "week_name",
                    "unique_name": "Week",
                    "sort_column": "week"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "pk_date"
                    ],
                    "label": "Day",
                    "name_column": "date_name",
                    "unique_name": "DayWeek",
                    "sort_column": "pk_date"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Date Month Hierarchy",
                    "label": "Date Month Hierarchy",
                    "levels": [
                        {
                            "unique_name": "YearMonth",
                            "time_unit": "year"
                        },
                        {
                            "unique_name": "Quarter",
                            "time_unit": "quarter",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_quarter_number",
                                    "label": "Quarter Number",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "quarter_of_year",
                                    "key_columns": [
                                        "quarter_of_year"
                                    ],
                                    "sort_column": "quarter_of_year"
                                }
                            ]
                        },
                        {
                            "unique_name": "Month1",
                            "time_unit": "month",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_month_start",
                                    "label": "Month Start",
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "month",
                                    "key_columns": [
                                        "month"
                                    ]
                                }
                            ]
                        },
                        {
                            "unique_name": "DayMonth",
                            "time_unit": "day",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_day_of_week_number",
                                    "label": "Day Of Week Number",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "day_of_week",
                                    "key_columns": [
                                        "day_of_week"
                                    ],
                                    "sort_column": "day_of_week"
                                },
                                {
                                    "unique_name": "d_day_of_week_name",
                                    "label": "Day Of Week Name",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "day_of_week_name",
                                    "key_columns": [
                                        "day_of_week_name"
                                    ],
                                    "sort_column": "day_of_week"
                                },
                                {
                                    "unique_name": "Day_Date",
                                    "label": "Day Date",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "pk_date",
                                    "key_columns": [
                                        "pk_date"
                                    ],
                                    "sort_column": "pk_date"
                                },
                                {
                                    "unique_name": "w_day_of_week_name",
                                    "label": "W Day Of Week Name",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "day_of_week_name",
                                    "key_columns": [
                                        "day_of_week_name"
                                    ],
                                    "sort_column": "day_of_week_name"
                                },
                                {
                                    "unique_name": "w_day_of_week_number",
                                    "label": "W Day Of Week Number",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "day_of_week",
                                    "key_columns": [
                                        "day_of_week"
                                    ],
                                    "sort_column": "day_of_week"
                                },
                                {
                                    "unique_name": "W_Day_Date",
                                    "label": "W Day Date",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "pk_date",
                                    "key_columns": [
                                        "pk_date"
                                    ],
                                    "sort_column": "pk_date"
                                }
                            ]
                        }
                    ],
                    "description": "A Gregorian Date Hierarchy.  Organizes time by Year, Quarter, Month, Day",
                    "folder": "Date Attributes",
                    "filter_empty": "yes"
                },
                {
                    "unique_name": "Date Week Hierarchy",
                    "label": "Date Week Hierarchy",
                    "levels": [
                        {
                            "unique_name": "YearWeek",
                            "time_unit": "year"
                        },
                        {
                            "unique_name": "Week",
                            "time_unit": "week",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_week_of_year",
                                    "label": "Week Of Year",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "week_of_year",
                                    "key_columns": [
                                        "week_of_year"
                                    ],
                                    "sort_column": "week_of_year"
                                }
                            ]
                        },
                        {
                            "unique_name": "DayMonth",
                            "time_unit": "day"
                        }
                    ],
                    "folder": "Date Attributes",
                    "filter_empty": "yes"
                }
            ],
            "label": "Date Dimension",
            "object_type": "dimension",
            "unique_name": "Date Dimension",
            "description": "Date Dimension for ISO8601 calendar with 2 hierarchies",
            "type": "time"
        },
        {
            "level_attributes": [
                {
                    "dataset": "stg_locations_dataset",
                    "key_columns": [
                        "location"
                    ],
                    "label": "location",
                    "name_column": "location",
                    "unique_name": "location"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Stg_locations Hierarchy",
                    "label": "Stg_locations Hierarchy",
                    "levels": [
                        {
                            "unique_name": "location",
                            "secondary_attributes": [
                                {
                                    "unique_name": "location_name",
                                    "label": "location_name",
                                    "dataset": "stg_locations_dataset",
                                    "name_column": "location_name",
                                    "key_columns": [
                                        "location_name"
                                    ]
                                },
                                {
                                    "unique_name": "opened_at",
                                    "label": "opened_at",
                                    "dataset": "stg_locations_dataset",
                                    "name_column": "opened_at",
                                    "key_columns": [
                                        "opened_at"
                                    ]
                                }
                            ]
                        }
                    ],
                    "folder": "Stg_locations"
                }
            ],
            "label": "Dim stg_locations",
            "object_type": "dimension",
            "unique_name": "Dim_stg_locations",
            "description": "Location dimension table. The grain of the table is one row per location.\n"
        },
        {
            "level_attributes": [
                {
                    "dataset": "customers_dataset",
                    "key_columns": [
                        "customer"
                    ],
                    "label": "customer",
                    "name_column": "customer",
                    "unique_name": "customer"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Customers Hierarchy",
                    "label": "Customers Hierarchy",
                    "levels": [
                        {
                            "unique_name": "customer",
                            "secondary_attributes": [
                                {
                                    "unique_name": "customer_name",
                                    "label": "customer_name",
                                    "dataset": "customers_dataset",
                                    "name_column": "customer_name",
                                    "key_columns": [
                                        "customer_name"
                                    ]
                                },
                                {
                                    "unique_name": "customer_type",
                                    "label": "customer_type",
                                    "dataset": "customers_dataset",
                                    "name_column": "customer_type",
                                    "key_columns": [
                                        "customer_type"
                                    ]
                                },
                                {
                                    "unique_name": "first_ordered_at",
                                    "label": "first_ordered_at",
                                    "dataset": "customers_dataset",
                                    "name_column": "first_ordered_at",
                                    "key_columns": [
                                        "first_ordered_at"
                                    ]
                                },
                                {
                                    "unique_name": "last_ordered_at",
                                    "label": "last_ordered_at",
                                    "dataset": "customers_dataset",
                                    "name_column": "last_ordered_at",
                                    "key_columns": [
                                        "last_ordered_at"
                                    ]
                                }
                            ]
                        }
                    ],
                    "folder": "Customers"
                }
            ],
            "label": "Dim customers",
            "object_type": "dimension",
            "unique_name": "Dim_customers",
            "description": "Customer grain mart.\n"
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "order_id"
                    ],
                    "label": "order_id",
                    "name_column": "order_id",
                    "unique_name": "order_id"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Orders Hierarchy",
                    "label": "Orders Hierarchy",
                    "levels": [
                        {
                            "unique_name": "order_id",
                            "secondary_attributes": [
                                {
                                    "unique_name": "ordered_at",
                                    "label": "ordered_at",
                                    "dataset": "orders_dataset",
                                    "name_column": "ordered_at",
                                    "key_columns": [
                                        "ordered_at"
                                    ]
                                },
                                {
                                    "unique_name": "ordered_at_test",
                                    "label": "ordered_at_test",
                                    "dataset": "orders_dataset",
                                    "name_column": "ordered_at_test",
                                    "key_columns": [
                                        "ordered_at_test"
                                    ]
                                },
                                {
                                    "unique_name": "order_total_dim",
                                    "label": "order_total_dim",
                                    "dataset": "orders_dataset",
                                    "name_column": "order_total_dim",
                                    "key_columns": [
                                        "order_total_dim"
                                    ]
                                },
                                {
                                    "unique_name": "is_food_order",
                                    "label": "is_food_order",
                                    "dataset": "orders_dataset",
                                    "name_column": "is_food_order",
                                    "key_columns": [
                                        "is_food_order"
                                    ]
                                },
                                {
                                    "unique_name": "is_drink_order",
                                    "label": "is_drink_order",
                                    "dataset": "orders_dataset",
                                    "name_column": "is_drink_order",
                                    "key_columns": [
                                        "is_drink_order"
                                    ]
                                }
                            ]
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim orders",
            "object_type": "dimension",
            "unique_name": "Dim_orders",
            "description": "Order fact table. This table is at the order grain with one row per order.\n"
        },
        {
            "level_attributes": [
                {
                    "dataset": "stg_products_dataset",
                    "key_columns": [
                        "product"
                    ],
                    "label": "product",
                    "name_column": "product",
                    "unique_name": "product"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Stg_products Hierarchy",
                    "label": "Stg_products Hierarchy",
                    "levels": [
                        {
                            "unique_name": "product",
                            "secondary_attributes": [
                                {
                                    "unique_name": "product_name",
                                    "label": "product_name",
                                    "dataset": "stg_products_dataset",
                                    "name_column": "product_name",
                                    "key_columns": [
                                        "product_name"
                                    ]
                                },
                                {
                                    "unique_name": "product_type",
                                    "label": "product_type",
                                    "dataset": "stg_products_dataset",
                                    "name_column": "product_type",
                                    "key_columns": [
                                        "product_type"
                                    ]
                                },
                                {
                                    "unique_name": "product_description",
                                    "label": "product_description",
                                    "dataset": "stg_products_dataset",
                                    "name_column": "product_description",
                                    "key_columns": [
                                        "product_description"
                                    ]
                                },
                                {
                                    "unique_name": "is_food_item",
                                    "label": "is_food_item",
                                    "dataset": "stg_products_dataset",
                                    "name_column": "is_food_item",
                                    "key_columns": [
                                        "is_food_item"
                                    ]
                                },
                                {
                                    "unique_name": "is_drink_item",
                                    "label": "is_drink_item",
                                    "dataset": "stg_products_dataset",
                                    "name_column": "is_drink_item",
                                    "key_columns": [
                                        "is_drink_item"
                                    ]
                                },
                                {
                                    "unique_name": "product_price",
                                    "label": "product_price",
                                    "dataset": "stg_products_dataset",
                                    "name_column": "product_price",
                                    "key_columns": [
                                        "product_price"
                                    ]
                                }
                            ]
                        }
                    ],
                    "folder": "Stg_products"
                }
            ],
            "label": "Dim stg_products",
            "object_type": "dimension",
            "unique_name": "Dim_stg_products",
            "description": "Product dimension table. The grain of the table is one row per product.\n"
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "order_total"
                    ],
                    "label": "order_total_dim",
                    "name_column": "order_total",
                    "unique_name": "order_total_dim"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "order_total_dim_Hierarchy",
                    "label": "order_total_dim_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "order_total_dim"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim order_total_dim",
            "object_type": "dimension",
            "unique_name": "Dim_order_total_dim",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "is_food_order"
                    ],
                    "label": "is_food_order",
                    "name_column": "is_food_order",
                    "unique_name": "is_food_order"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_food_order_Hierarchy",
                    "label": "is_food_order_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_food_order"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim is_food_order",
            "object_type": "dimension",
            "unique_name": "Dim_is_food_order",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "is_drink_order"
                    ],
                    "label": "is_drink_order",
                    "name_column": "is_drink_order",
                    "unique_name": "is_drink_order"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_drink_order_Hierarchy",
                    "label": "is_drink_order_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_drink_order"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim is_drink_order",
            "object_type": "dimension",
            "unique_name": "Dim_is_drink_order",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "order_items_dataset",
                    "key_columns": [
                        "is_food_item"
                    ],
                    "label": "is_food_item",
                    "name_column": "is_food_item",
                    "unique_name": "is_food_item"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_food_item_Hierarchy",
                    "label": "is_food_item_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_food_item"
                        }
                    ],
                    "folder": "Order_items"
                }
            ],
            "label": "Dim is_food_item",
            "object_type": "dimension",
            "unique_name": "Dim_is_food_item",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "order_items_dataset",
                    "key_columns": [
                        "is_drink_item"
                    ],
                    "label": "is_drink_item",
                    "name_column": "is_drink_item",
                    "unique_name": "is_drink_item"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_drink_item_Hierarchy",
                    "label": "is_drink_item_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_drink_item"
                        }
                    ],
                    "folder": "Order_items"
                }
            ],
            "label": "Dim is_drink_item",
            "object_type": "dimension",
            "unique_name": "Dim_is_drink_item",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "customers_dataset",
                    "key_columns": [
                        "customer_name"
                    ],
                    "label": "customer_name",
                    "name_column": "customer_name",
                    "unique_name": "customer_name"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "customer_name_Hierarchy",
                    "label": "customer_name_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "customer_name"
                        }
                    ],
                    "folder": "Customers"
                }
            ],
            "label": "Dim customer_name",
            "object_type": "dimension",
            "unique_name": "Dim_customer_name",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "customers_dataset",
                    "key_columns": [
                        "customer_type"
                    ],
                    "label": "customer_type",
                    "name_column": "customer_type",
                    "unique_name": "customer_type"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "customer_type_Hierarchy",
                    "label": "customer_type_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "customer_type"
                        }
                    ],
                    "folder": "Customers"
                }
            ],
            "label": "Dim customer_type",
            "object_type": "dimension",
            "unique_name": "Dim_customer_type",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "stg_locations_dataset",
                    "key_columns": [
                        "location_name"
                    ],
                    "label": "location_name",
                    "name_column": "location_name",
                    "unique_name": "location_name"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "location_name_Hierarchy",
                    "label": "location_name_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "location_name"
                        }
                    ],
                    "folder": "Stg_locations"
                }
            ],
            "label": "Dim location_name",
            "object_type": "dimension",
            "unique_name": "Dim_location_name",
            "is_degenerate": true
        }
    ],
    "_measures": [
        {
            "label": "order_total",
            "unique_name": "order_total",
            "object_type": "metric",
            "column": "order_total",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "The total amount for each order including taxes.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "order_count",
            "unique_name": "order_count",
            "object_type": "metric",
            "column": "order_count",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "tax_paid",
            "unique_name": "tax_paid",
            "object_type": "metric",
            "column": "tax_paid",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "The total tax paid on each order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "customers_with_orders",
            "unique_name": "customers_with_orders",
            "object_type": "metric",
            "column": "customers_with_orders",
            "dataset": "orders_dataset",
            "calculation_method": "count distinct",
            "folder": "Orders",
            "description": "Distinct count of customers placing orders",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "locations_with_orders",
            "unique_name": "locations_with_orders",
            "object_type": "metric",
            "column": "locations_with_orders",
            "dataset": "orders_dataset",
            "calculation_method": "count distinct",
            "folder": "Orders",
            "description": "Distinct count of locations with order",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "order_cost",
            "unique_name": "order_cost",
            "object_type": "metric",
            "column": "order_cost",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "The cost for each order item. Cost is calculated as a sum of the supply cost for each order item.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "revenue",
            "unique_name": "revenue",
            "object_type": "metric",
            "column": "revenue",
            "dataset": "order_items_dataset",
            "calculation_method": "sum",
            "folder": "Order_items",
            "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "food_revenue",
            "unique_name": "food_revenue",
            "object_type": "metric",
            "column": "food_revenue",
            "dataset": "order_items_dataset",
            "calculation_method": "sum",
            "folder": "Order_items",
            "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "drink_revenue",
            "unique_name": "drink_revenue",
            "object_type": "metric",
            "column": "drink_revenue",
            "dataset": "order_items_dataset",
            "calculation_method": "sum",
            "folder": "Order_items",
            "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "median_revenue",
            "unique_name": "median_revenue",
            "object_type": "metric",
            "column": "median_revenue",
            "dataset": "order_items_dataset",
            "calculation_method": "average",
            "folder": "Order_items",
            "description": "The median revenue generated for each order item.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "count_lifetime_orders",
            "unique_name": "count_lifetime_orders",
            "object_type": "metric",
            "column": "count_lifetime_orders",
            "dataset": "customers_dataset",
            "calculation_method": "sum",
            "folder": "Customers",
            "description": "Total count of orders per customer.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "lifetime_spend_pretax",
            "unique_name": "lifetime_spend_pretax",
            "object_type": "metric",
            "column": "lifetime_spend_pretax",
            "dataset": "customers_dataset",
            "calculation_method": "sum",
            "folder": "Customers",
            "description": "Customer lifetime spend before taxes.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "lifetime_spend",
            "unique_name": "lifetime_spend",
            "object_type": "metric",
            "column": "lifetime_spend",
            "dataset": "customers_dataset",
            "calculation_method": "sum",
            "folder": "Customers",
            "description": "Gross customer lifetime spend inclusive of taxes.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "average_tax_rate",
            "unique_name": "average_tax_rate",
            "object_type": "metric",
            "column": "average_tax_rate",
            "dataset": "stg_locations_dataset",
            "calculation_method": "average",
            "folder": "Stg_locations",
            "description": "Average tax rate.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "orders",
            "unique_name": "orders",
            "object_type": "metric",
            "column": "order_count",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "Count of orders.",
            "unrelated_dimensions_handling": "repeat"
        }
    ],
    "_measuresCalculated": [
        {
            "label": "orders_fill_nulls_with_zero",
            "unique_name": "orders_fill_nulls_with_zero",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[order_count]) THEN 0 ELSE [Measures].[order_count] END",
            "folder": "Orders",
            "description": "Example metric colaescing null to zero."
        },
        {
            "label": "twice_orders_fill_nulls_with_0",
            "unique_name": "twice_orders_fill_nulls_with_0",
            "object_type": "metric_calc",
            "expression": "2 * [Measures].[orders_fill_nulls_with_zero]",
            "folder": "Other Calculations",
            "description": "Example derived metric."
        },
        {
            "label": "revenue_fill_nulls",
            "unique_name": "revenue_fill_nulls",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[revenue]) THEN 0 ELSE [Measures].[revenue] END",
            "folder": "Order_items",
            "description": "Sum of the product revenue for each order item. Excludes tax."
        },
        {
            "label": "food_revenue_pct",
            "unique_name": "food_revenue_pct",
            "object_type": "metric_calc",
            "expression": "[Measures].[food_revenue] / [Measures].[revenue]",
            "folder": "Other Calculations",
            "description": "The % of order revenue from food."
        },
        {
            "label": "revenue_prev_month",
            "unique_name": "revenue_prev_month",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[revenue]) THEN NULL ELSE (ParallelPeriod([ordered_at Date Dimension].[ordered_at Date Month Hierarchy].[ordered_at Month1], 1, [ordered_at Date Dimension].[ordered_at Date Month Hierarchy].CurrentMember), [Measures].[revenue]) END",
            "folder": "Order_items",
            "description": "Calculation created from parent metric 'revenue_growth_mom'"
        },
        {
            "label": "revenue_growth_mom",
            "unique_name": "revenue_growth_mom",
            "object_type": "metric_calc",
            "expression": "([Measures].[revenue] - [Measures].[revenue_prev_month])*100/[Measures].[revenue_prev_month]",
            "folder": "Other Calculations",
            "description": "Percentage growth of revenue compared to 1 month ago. Excluded tax"
        },
        {
            "label": "order_gross_profit",
            "unique_name": "order_gross_profit",
            "object_type": "metric_calc",
            "expression": "[Measures].[revenue] - [Measures].[order_cost]",
            "folder": "Other Calculations",
            "description": "Gross profit from each order."
        },
        {
            "label": "cumulative_revenue",
            "unique_name": "cumulative_revenue",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[revenue]) THEN NULL ELSE Aggregate(PeriodsToDate([ordered_at Date Dimension].[ordered_at Date Week Hierarchy].[ordered_at YearWeek], [ordered_at Date Dimension].[ordered_at Date Week Hierarchy].CurrentMember), [Measures].[revenue]) END",
            "folder": "Order_items",
            "description": "The cumulative revenue for all orders."
        }
    ],
    "_catalog": {
        "as_version": 1,
        "label": "jaffle_shop",
        "object_type": "catalog",
        "unique_name": "jaffle_shop.catalog",
        "aggressive_agg_promotion": false,
        "build_speculative_aggs": false
    }
}