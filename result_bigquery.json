{
    "_connections": [
        {
            "unique_name": "dbt_connection_BigQuery",
            "object_type": "connection",
            "label": "DBT bigquery Connection BigQuery",
            "database": "ATSCALE-DATA-WAREHOUSE",
            "schema": "DBT_DWOOD",
            "as_connection": "BigQuery"
        }
    ],
    "_models": [
        {
            "label": "jaffle_shop",
            "relationships": [
                {
                    "unique_name": "orders_dataset_Dim_stg_locations",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "LOCATION"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_stg_locations",
                        "level": "location"
                    }
                },
                {
                    "unique_name": "orders_dataset_Dim_customers",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "CUSTOMER"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_customers",
                        "level": "customer"
                    }
                },
                {
                    "unique_name": "order_items_dataset_Dim_orders",
                    "from": {
                        "dataset": "order_items_dataset",
                        "join_columns": [
                            "ORDER_ID"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_orders",
                        "level": "order_id"
                    }
                },
                {
                    "unique_name": "order_items_dataset_Dim_stg_products",
                    "from": {
                        "dataset": "order_items_dataset",
                        "join_columns": [
                            "PRODUCT"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_stg_products",
                        "level": "product"
                    }
                },
                {
                    "unique_name": "stg_locations_dataset_Dim_stg_locations",
                    "from": {
                        "dataset": "stg_locations_dataset",
                        "join_columns": [
                            "LOCATION"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_stg_locations",
                        "level": "location"
                    }
                },
                {
                    "unique_name": "customers_dataset_Dim_customers",
                    "from": {
                        "dataset": "customers_dataset",
                        "join_columns": [
                            "CUSTOMER"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_customers",
                        "level": "customer"
                    }
                },
                {
                    "unique_name": "orders_dataset_Dim_orders",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "ORDER_ID"
                        ]
                    },
                    "to": {
                        "dimension": "Dim_orders",
                        "level": "order_id"
                    }
                },
                {
                    "unique_name": "orders_dataset_Date Dimension_ordered_at",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "ORDERED_AT"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "ordered_at {0}"
                },
                {
                    "unique_name": "orders_dataset_Date Dimension_ordered_at_test",
                    "from": {
                        "dataset": "orders_dataset",
                        "join_columns": [
                            "ORDERED_AT_TEST"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "ordered_at_test {0}"
                },
                {
                    "unique_name": "order_items_dataset_Date Dimension_ordered_at",
                    "from": {
                        "dataset": "order_items_dataset",
                        "join_columns": [
                            "ORDERED_AT"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "ordered_at {0}"
                },
                {
                    "unique_name": "customers_dataset_Date Dimension_first_ordered_at",
                    "from": {
                        "dataset": "customers_dataset",
                        "join_columns": [
                            "FIRST_ORDERED_AT"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "first_ordered_at {0}"
                },
                {
                    "unique_name": "customers_dataset_Date Dimension_last_ordered_at",
                    "from": {
                        "dataset": "customers_dataset",
                        "join_columns": [
                            "LAST_ORDERED_AT"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "last_ordered_at {0}"
                },
                {
                    "unique_name": "stg_locations_dataset_Date Dimension_opened_at",
                    "from": {
                        "dataset": "stg_locations_dataset",
                        "join_columns": [
                            "OPENED_AT"
                        ]
                    },
                    "to": {
                        "dimension": "Date Dimension",
                        "level": "DayMonth"
                    },
                    "role_play": "opened_at {0}"
                }
            ],
            "metrics": [
                {
                    "unique_name": "order_total",
                    "folder": "Orders"
                },
                {
                    "unique_name": "order_count",
                    "folder": "Orders"
                },
                {
                    "unique_name": "tax_paid",
                    "folder": "Orders"
                },
                {
                    "unique_name": "customers_with_orders",
                    "folder": "Orders"
                },
                {
                    "unique_name": "locations_with_orders",
                    "folder": "Orders"
                },
                {
                    "unique_name": "order_cost",
                    "folder": "Orders"
                },
                {
                    "unique_name": "revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "food_revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "drink_revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "median_revenue",
                    "folder": "Order_items"
                },
                {
                    "unique_name": "count_lifetime_orders",
                    "folder": "Customers"
                },
                {
                    "unique_name": "lifetime_spend_pretax",
                    "folder": "Customers"
                },
                {
                    "unique_name": "lifetime_spend",
                    "folder": "Customers"
                },
                {
                    "unique_name": "average_tax_rate",
                    "folder": "Stg_locations"
                },
                {
                    "unique_name": "orders",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "orders_fill_nulls_with_zero",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "twice_orders_fill_nulls_with_0",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "orders_last_7_days",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "food_revenue_pct",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "revenue_prev_month",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "revenue_growth_mom",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "order_gross_profit",
                    "folder": "Other Calculations"
                },
                {
                    "unique_name": "cumulative_revenue",
                    "folder": "Other Calculations"
                }
            ],
            "object_type": "model",
            "unique_name": "jaffle_shop",
            "dimensions": [
                "Dim_order_total_dim",
                "Dim_is_food_order",
                "Dim_is_drink_order",
                "Dim_is_food_item",
                "Dim_is_drink_item",
                "Dim_customer_name",
                "Dim_customer_type",
                "Dim_location_name"
            ]
        }
    ],
    "_datasets": [
        {
            "object_type": "dataset",
            "unique_name": "orders_dataset",
            "label": "orders_dataset",
            "columns": [
                {
                    "name": "ORDER_ID",
                    "data_type": "string"
                },
                {
                    "name": "LOCATION",
                    "data_type": "string",
                    "sql": "LOCATION_ID"
                },
                {
                    "name": "CUSTOMER",
                    "data_type": "string",
                    "sql": "CUSTOMER_ID"
                },
                {
                    "name": "ORDERED_AT",
                    "data_type": "datetime"
                },
                {
                    "name": "ORDERED_AT_TEST",
                    "data_type": "datetime",
                    "sql": "ORDERED_AT"
                },
                {
                    "name": "ORDER_TOTAL_DIM",
                    "data_type": "string",
                    "sql": "ORDER_TOTAL"
                },
                {
                    "name": "IS_FOOD_ORDER",
                    "data_type": "boolean"
                },
                {
                    "name": "IS_DRINK_ORDER",
                    "data_type": "boolean"
                },
                {
                    "name": "ORDER_TOTAL",
                    "data_type": "decimal"
                },
                {
                    "name": "ORDER_COUNT",
                    "data_type": "long",
                    "sql": "1"
                },
                {
                    "name": "TAX_PAID",
                    "data_type": "decimal"
                },
                {
                    "name": "CUSTOMERS_WITH_ORDERS",
                    "data_type": "string",
                    "sql": "CUSTOMER_ID"
                },
                {
                    "name": "LOCATIONS_WITH_ORDERS",
                    "data_type": "string",
                    "sql": "LOCATION_ID"
                },
                {
                    "name": "ORDER_COST",
                    "data_type": "decimal"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "ORDERS"
        },
        {
            "object_type": "dataset",
            "unique_name": "order_items_dataset",
            "label": "order_items_dataset",
            "columns": [
                {
                    "name": "ORDER_ITEM",
                    "data_type": "string",
                    "sql": "ORDER_ITEM_ID"
                },
                {
                    "name": "ORDER_ID",
                    "data_type": "string"
                },
                {
                    "name": "PRODUCT",
                    "data_type": "string",
                    "sql": "PRODUCT_ID"
                },
                {
                    "name": "ORDERED_AT",
                    "data_type": "datetime",
                    "sql": "CAST(ORDERED_AT AS DATETIME)"
                },
                {
                    "name": "IS_FOOD_ITEM",
                    "data_type": "boolean"
                },
                {
                    "name": "IS_DRINK_ITEM",
                    "data_type": "boolean"
                },
                {
                    "name": "REVENUE",
                    "data_type": "decimal",
                    "sql": "PRODUCT_PRICE"
                },
                {
                    "name": "FOOD_REVENUE",
                    "data_type": "decimal",
                    "sql": "CASE WHEN IS_FOOD_ITEM = 1 THEN PRODUCT_PRICE ELSE 0 END"
                },
                {
                    "name": "DRINK_REVENUE",
                    "data_type": "decimal",
                    "sql": "CASE WHEN IS_DRINK_ITEM = 1 THEN PRODUCT_PRICE ELSE 0 END"
                },
                {
                    "name": "MEDIAN_REVENUE",
                    "data_type": "decimal",
                    "sql": "PRODUCT_PRICE"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "ORDER_ITEMS"
        },
        {
            "object_type": "dataset",
            "unique_name": "customers_dataset",
            "label": "customers_dataset",
            "columns": [
                {
                    "name": "CUSTOMER",
                    "data_type": "string",
                    "sql": "CUSTOMER_ID"
                },
                {
                    "name": "CUSTOMER_NAME",
                    "data_type": "string"
                },
                {
                    "name": "CUSTOMER_TYPE",
                    "data_type": "string"
                },
                {
                    "name": "FIRST_ORDERED_AT",
                    "data_type": "datetime"
                },
                {
                    "name": "LAST_ORDERED_AT",
                    "data_type": "datetime"
                },
                {
                    "name": "COUNT_LIFETIME_ORDERS",
                    "data_type": "long"
                },
                {
                    "name": "LIFETIME_SPEND_PRETAX",
                    "data_type": "decimal"
                },
                {
                    "name": "LIFETIME_SPEND",
                    "data_type": "decimal"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "CUSTOMERS"
        },
        {
            "object_type": "dataset",
            "unique_name": "stg_locations_dataset",
            "label": "stg_locations_dataset",
            "columns": [
                {
                    "name": "LOCATION",
                    "data_type": "string",
                    "sql": "LOCATION_ID"
                },
                {
                    "name": "LOCATION_NAME",
                    "data_type": "string"
                },
                {
                    "name": "OPENED_AT",
                    "data_type": "datetime"
                },
                {
                    "name": "AVERAGE_TAX_RATE",
                    "data_type": "decimal",
                    "sql": "TAX_RATE"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "STG_LOCATIONS"
        },
        {
            "object_type": "dataset",
            "unique_name": "stg_products_dataset",
            "label": "stg_products_dataset",
            "columns": [
                {
                    "name": "PRODUCT",
                    "data_type": "string",
                    "sql": "PRODUCT_ID"
                },
                {
                    "name": "PRODUCT_NAME",
                    "data_type": "string"
                },
                {
                    "name": "PRODUCT_TYPE",
                    "data_type": "string"
                },
                {
                    "name": "PRODUCT_DESCRIPTION",
                    "data_type": "string"
                },
                {
                    "name": "IS_FOOD_ITEM",
                    "data_type": "boolean"
                },
                {
                    "name": "IS_DRINK_ITEM",
                    "data_type": "boolean"
                },
                {
                    "name": "PRODUCT_PRICE",
                    "data_type": "string"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "table": "STG_PRODUCTS"
        },
        {
            "object_type": "dataset",
            "unique_name": "dim_time_dataset",
            "label": "dim_time_dataset",
            "columns": [
                {
                    "name": "NAME",
                    "data_type": "string"
                },
                {
                    "name": "PK_DATE",
                    "data_type": "datetime"
                },
                {
                    "name": "DATEKEY",
                    "data_type": "int"
                },
                {
                    "name": "DATE_NAME",
                    "data_type": "string"
                },
                {
                    "name": "YEAR",
                    "data_type": "string"
                },
                {
                    "name": "YEAR_NAME",
                    "data_type": "string"
                },
                {
                    "name": "HALF_YEAR",
                    "data_type": "date"
                },
                {
                    "name": "HALF_YEAR_NAME",
                    "data_type": "string"
                },
                {
                    "name": "QUARTER",
                    "data_type": "date"
                },
                {
                    "name": "QUARTER_NAME",
                    "data_type": "string"
                },
                {
                    "name": "MONTH",
                    "data_type": "date"
                },
                {
                    "name": "MONTH_NAME",
                    "data_type": "string"
                },
                {
                    "name": "WEEK",
                    "data_type": "date"
                },
                {
                    "name": "WEEK_NAME",
                    "data_type": "string"
                },
                {
                    "name": "DAY_OF_YEAR",
                    "data_type": "int"
                },
                {
                    "name": "DAY_OF_YEAR_NAME",
                    "data_type": "string"
                },
                {
                    "name": "DAY_OF_WEEK",
                    "data_type": "int"
                },
                {
                    "name": "DAY_OF_WEEK_NAME",
                    "data_type": "string"
                },
                {
                    "name": "WEEK_OF_YEAR",
                    "data_type": "int"
                },
                {
                    "name": "WEEK_OF_YEAR_NAME",
                    "data_type": "string"
                },
                {
                    "name": "MONTH_OF_YEAR",
                    "data_type": "int"
                },
                {
                    "name": "MONTH_OF_YEAR_NAME",
                    "data_type": "string"
                },
                {
                    "name": "QUARTER_OF_YEAR",
                    "data_type": "int"
                },
                {
                    "name": "QUARTER_OF_YEAR_NAME",
                    "data_type": "string"
                }
            ],
            "connection_id": "dbt_connection_BigQuery",
            "sql": "SELECT TIMESTAMP(date_day) as pk_date, cast(FORMAT_DATE(\"%Y%m%d\", date_day) as decimal) as datekey, FORMAT_DATE('%A, %B %d, %Y', date_day) as date_name, CAST(EXTRACT(YEAR from date_day) AS STRING) as year, concat(\"Calendar \",FORMAT_DATE('%Y', date_day)) as year_name, IF(EXTRACT(QUARTER FROM date_day) < 3, DATE_TRUNC(date_day,YEAR), DATE_ADD(DATE_TRUNC(date_day,YEAR), INTERVAL 2 QUARTER)) as half_year, IF(EXTRACT(QUARTER FROM date_day) < 3, concat(\"Semester 1, \",FORMAT_DATE('%Y', date_day)), concat(\"Semester 2, \", FORMAT_DATE('%Y', date_day))) as half_year_name, DATE_TRUNC(date_day, QUARTER) as quarter, FORMAT_DATE('Quarter %Q, %Y', date_day) as quarter_name, DATE_TRUNC(date_day, MONTH) as month, FORMAT_DATE('%B %Y', date_day) as month_name, DATE_TRUNC(date_day, WEEK) as week, concat(\"Week \", EXTRACT(WEEK from date_day), FORMAT_DATE(', %Y', date_day)) as week_name, EXTRACT(DAYOFYEAR from date_day) as day_of_year, concat(\"Day \", EXTRACT(DAYOFYEAR from date_day)) as day_of_year_name, EXTRACT(DAYOFWEEK from date_day) as day_of_week, FORMAT_DATE('%a', date_day) as day_of_week_name, EXTRACT(WEEK from date_day) as week_of_year, concat(\"Week \", EXTRACT(WEEK from date_day)) as week_of_year_name, EXTRACT(MONTH from date_day) as month_of_year, FORMAT_DATE('%B', date_day) as month_of_year_name, EXTRACT(QUARTER from date_day) as quarter_of_year, concat(\"Quarter \", EXTRACT(QUARTER from date_day)) as quarter_of_year_name    FROM DBT_DWOOD.metricflow_time_spine"
        }
    ],
    "_dimensions": [
        {
            "level_attributes": [
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "YEAR"
                    ],
                    "label": "Year",
                    "name_column": "YEAR_NAME",
                    "unique_name": "YearMonth",
                    "description": "Year level of the Standard Calendar Month Hierarchy"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "QUARTER"
                    ],
                    "label": "Quarter",
                    "name_column": "QUARTER_NAME",
                    "unique_name": "Quarter",
                    "sort_column": "QUARTER"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "MONTH"
                    ],
                    "label": "Month",
                    "name_column": "MONTH_NAME",
                    "unique_name": "Month1",
                    "sort_column": "MONTH"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "PK_DATE"
                    ],
                    "label": "Day",
                    "name_column": "DATE_NAME",
                    "unique_name": "DayMonth",
                    "description": "Day level of standard calendar Month Hierarchy",
                    "is_unique_key": true,
                    "sort_column": "PK_DATE",
                    "allowed_calcs_for_dma": [
                        "Siblings",
                        "ParallelPeriod",
                        "Ancestor",
                        "Descendants",
                        "PeriodsToDate"
                    ]
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "YEAR"
                    ],
                    "label": "Year",
                    "name_column": "YEAR_NAME",
                    "unique_name": "YearWeek",
                    "sort_column": "YEAR"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "WEEK"
                    ],
                    "label": "Week",
                    "name_column": "WEEK_NAME",
                    "unique_name": "Week",
                    "sort_column": "WEEK"
                },
                {
                    "dataset": "dim_time_dataset",
                    "key_columns": [
                        "PK_DATE"
                    ],
                    "label": "Day",
                    "name_column": "DATE_NAME",
                    "unique_name": "DayWeek",
                    "sort_column": "PK_DATE"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Date Month Hierarchy",
                    "label": "Date Month Hierarchy",
                    "levels": [
                        {
                            "unique_name": "YearMonth",
                            "time_unit": "year"
                        },
                        {
                            "unique_name": "Quarter",
                            "time_unit": "quarter",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_quarter_number",
                                    "label": "Quarter Number",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "QUARTER_OF_YEAR",
                                    "key_columns": [
                                        "QUARTER_OF_YEAR"
                                    ],
                                    "sort_column": "QUARTER_OF_YEAR"
                                }
                            ]
                        },
                        {
                            "unique_name": "Month1",
                            "time_unit": "month",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_month_start",
                                    "label": "Month Start",
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "MONTH",
                                    "key_columns": [
                                        "MONTH"
                                    ]
                                }
                            ]
                        },
                        {
                            "unique_name": "DayMonth",
                            "time_unit": "day",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_day_of_week_number",
                                    "label": "Day Of Week Number",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "DAY_OF_WEEK",
                                    "key_columns": [
                                        "DAY_OF_WEEK"
                                    ],
                                    "sort_column": "DAY_OF_WEEK"
                                },
                                {
                                    "unique_name": "d_day_of_week_name",
                                    "label": "Day Of Week Name",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "DAY_OF_WEEK_NAME",
                                    "key_columns": [
                                        "DAY_OF_WEEK_NAME"
                                    ],
                                    "sort_column": "DAY_OF_WEEK_NAME"
                                },
                                {
                                    "unique_name": "Day_Date",
                                    "label": "Day Date",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "PK_DATE",
                                    "key_columns": [
                                        "PK_DATE"
                                    ],
                                    "sort_column": "PK_DATE"
                                },
                                {
                                    "unique_name": "w_day_of_week_name",
                                    "label": "W Day Of Week Name",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "DAY_OF_WEEK_NAME",
                                    "key_columns": [
                                        "DAY_OF_WEEK_NAME"
                                    ],
                                    "sort_column": "DAY_OF_WEEK_NAME"
                                },
                                {
                                    "unique_name": "w_day_of_week_number",
                                    "label": "W Day Of Week Number",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "DAY_OF_WEEK",
                                    "key_columns": [
                                        "DAY_OF_WEEK"
                                    ],
                                    "sort_column": "DAY_OF_WEEK"
                                },
                                {
                                    "unique_name": "W_Day_Date",
                                    "label": "W Day Date",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "PK_DATE",
                                    "key_columns": [
                                        "PK_DATE"
                                    ],
                                    "sort_column": "PK_DATE"
                                }
                            ]
                        }
                    ],
                    "description": "A Gregorian Date Hierarchy.  Organizes time by Year, Quarter, Month, Day",
                    "folder": "Date Attributes",
                    "filter_empty": "yes"
                },
                {
                    "unique_name": "Date Week Hierarchy",
                    "label": "Date Week Hierarchy",
                    "levels": [
                        {
                            "unique_name": "YearWeek",
                            "time_unit": "year"
                        },
                        {
                            "unique_name": "Week",
                            "time_unit": "week",
                            "secondary_attributes": [
                                {
                                    "unique_name": "d_week_of_year",
                                    "label": "Week Of Year",
                                    "is_hidden": false,
                                    "folder": "Date Attributes",
                                    "dataset": "dim_time_dataset",
                                    "name_column": "WEEK_OF_YEAR",
                                    "key_columns": [
                                        "WEEK_OF_YEAR"
                                    ],
                                    "sort_column": "WEEK_OF_YEAR"
                                }
                            ]
                        },
                        {
                            "unique_name": "DayMonth",
                            "time_unit": "day"
                        }
                    ],
                    "folder": "Date Attributes",
                    "filter_empty": "yes"
                }
            ],
            "label": "Date Dimension",
            "object_type": "dimension",
            "unique_name": "Date Dimension",
            "description": "Date Dimension for ISO8601 calendar with 2 hierarchies",
            "type": "time"
        },
        {
            "level_attributes": [
                {
                    "dataset": "stg_locations_dataset",
                    "key_columns": [
                        "LOCATION"
                    ],
                    "label": "location",
                    "name_column": "LOCATION",
                    "unique_name": "location"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Stg_locations Hierarchy",
                    "label": "Stg_locations Hierarchy",
                    "levels": [
                        {
                            "unique_name": "location"
                        }
                    ],
                    "folder": "Stg_locations"
                }
            ],
            "label": "Dim stg_locations",
            "object_type": "dimension",
            "unique_name": "Dim_stg_locations",
            "description": "This dimension was generated from a relationship to dbt model 'stg_locations'"
        },
        {
            "level_attributes": [
                {
                    "dataset": "customers_dataset",
                    "key_columns": [
                        "CUSTOMER"
                    ],
                    "label": "customer",
                    "name_column": "CUSTOMER",
                    "unique_name": "customer"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Customers Hierarchy",
                    "label": "Customers Hierarchy",
                    "levels": [
                        {
                            "unique_name": "customer"
                        }
                    ],
                    "folder": "Customers"
                }
            ],
            "label": "Dim customers",
            "object_type": "dimension",
            "unique_name": "Dim_customers",
            "description": "This dimension was generated from a relationship to dbt model 'customers'"
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "ORDER_ID"
                    ],
                    "label": "order_id",
                    "name_column": "ORDER_ID",
                    "unique_name": "order_id"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Orders Hierarchy",
                    "label": "Orders Hierarchy",
                    "levels": [
                        {
                            "unique_name": "order_id"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim orders",
            "object_type": "dimension",
            "unique_name": "Dim_orders",
            "description": "This dimension was generated from a relationship to dbt model 'orders'"
        },
        {
            "level_attributes": [
                {
                    "dataset": "stg_products_dataset",
                    "key_columns": [
                        "PRODUCT"
                    ],
                    "label": "product",
                    "name_column": "PRODUCT",
                    "unique_name": "product"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "Stg_products Hierarchy",
                    "label": "Stg_products Hierarchy",
                    "levels": [
                        {
                            "unique_name": "product"
                        }
                    ],
                    "folder": "Stg_products"
                }
            ],
            "label": "Dim stg_products",
            "object_type": "dimension",
            "unique_name": "Dim_stg_products",
            "description": "This dimension was generated from a relationship to dbt model 'stg_products'"
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "ORDER_TOTAL"
                    ],
                    "label": "order_total_dim",
                    "name_column": "ORDER_TOTAL",
                    "unique_name": "order_total_dim"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "order_total_dim_Hierarchy",
                    "label": "order_total_dim_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "order_total_dim"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim order_total_dim",
            "object_type": "dimension",
            "unique_name": "Dim_order_total_dim",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "IS_FOOD_ORDER"
                    ],
                    "label": "is_food_order",
                    "name_column": "IS_FOOD_ORDER",
                    "unique_name": "is_food_order"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_food_order_Hierarchy",
                    "label": "is_food_order_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_food_order"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim is_food_order",
            "object_type": "dimension",
            "unique_name": "Dim_is_food_order",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "orders_dataset",
                    "key_columns": [
                        "IS_DRINK_ORDER"
                    ],
                    "label": "is_drink_order",
                    "name_column": "IS_DRINK_ORDER",
                    "unique_name": "is_drink_order"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_drink_order_Hierarchy",
                    "label": "is_drink_order_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_drink_order"
                        }
                    ],
                    "folder": "Orders"
                }
            ],
            "label": "Dim is_drink_order",
            "object_type": "dimension",
            "unique_name": "Dim_is_drink_order",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "order_items_dataset",
                    "key_columns": [
                        "IS_FOOD_ITEM"
                    ],
                    "label": "is_food_item",
                    "name_column": "IS_FOOD_ITEM",
                    "unique_name": "is_food_item"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_food_item_Hierarchy",
                    "label": "is_food_item_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_food_item"
                        }
                    ],
                    "folder": "Order_items"
                }
            ],
            "label": "Dim is_food_item",
            "object_type": "dimension",
            "unique_name": "Dim_is_food_item",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "order_items_dataset",
                    "key_columns": [
                        "IS_DRINK_ITEM"
                    ],
                    "label": "is_drink_item",
                    "name_column": "IS_DRINK_ITEM",
                    "unique_name": "is_drink_item"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "is_drink_item_Hierarchy",
                    "label": "is_drink_item_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "is_drink_item"
                        }
                    ],
                    "folder": "Order_items"
                }
            ],
            "label": "Dim is_drink_item",
            "object_type": "dimension",
            "unique_name": "Dim_is_drink_item",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "customers_dataset",
                    "key_columns": [
                        "CUSTOMER_NAME"
                    ],
                    "label": "customer_name",
                    "name_column": "CUSTOMER_NAME",
                    "unique_name": "customer_name"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "customer_name_Hierarchy",
                    "label": "customer_name_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "customer_name"
                        }
                    ],
                    "folder": "Customers"
                }
            ],
            "label": "Dim customer_name",
            "object_type": "dimension",
            "unique_name": "Dim_customer_name",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "customers_dataset",
                    "key_columns": [
                        "CUSTOMER_TYPE"
                    ],
                    "label": "customer_type",
                    "name_column": "CUSTOMER_TYPE",
                    "unique_name": "customer_type"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "customer_type_Hierarchy",
                    "label": "customer_type_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "customer_type"
                        }
                    ],
                    "folder": "Customers"
                }
            ],
            "label": "Dim customer_type",
            "object_type": "dimension",
            "unique_name": "Dim_customer_type",
            "is_degenerate": true
        },
        {
            "level_attributes": [
                {
                    "dataset": "stg_locations_dataset",
                    "key_columns": [
                        "LOCATION_NAME"
                    ],
                    "label": "location_name",
                    "name_column": "LOCATION_NAME",
                    "unique_name": "location_name"
                }
            ],
            "hierarchies": [
                {
                    "unique_name": "location_name_Hierarchy",
                    "label": "location_name_Hierarchy",
                    "levels": [
                        {
                            "unique_name": "location_name"
                        }
                    ],
                    "folder": "Stg_locations"
                }
            ],
            "label": "Dim location_name",
            "object_type": "dimension",
            "unique_name": "Dim_location_name",
            "is_degenerate": true
        }
    ],
    "_measures": [
        {
            "label": "order_total",
            "unique_name": "order_total",
            "object_type": "metric",
            "column": "ORDER_TOTAL",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "The total amount for each order including taxes.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "order_count",
            "unique_name": "order_count",
            "object_type": "metric",
            "column": "ORDER_COUNT",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "tax_paid",
            "unique_name": "tax_paid",
            "object_type": "metric",
            "column": "TAX_PAID",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "The total tax paid on each order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "customers_with_orders",
            "unique_name": "customers_with_orders",
            "object_type": "metric",
            "column": "CUSTOMERS_WITH_ORDERS",
            "dataset": "orders_dataset",
            "calculation_method": "count distinct",
            "folder": "Orders",
            "description": "Distinct count of customers placing orders",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "locations_with_orders",
            "unique_name": "locations_with_orders",
            "object_type": "metric",
            "column": "LOCATIONS_WITH_ORDERS",
            "dataset": "orders_dataset",
            "calculation_method": "count distinct",
            "folder": "Orders",
            "description": "Distinct count of locations with order",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "order_cost",
            "unique_name": "order_cost",
            "object_type": "metric",
            "column": "ORDER_COST",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "The cost for each order item. Cost is calculated as a sum of the supply cost for each order item.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "revenue",
            "unique_name": "revenue",
            "object_type": "metric",
            "column": "REVENUE",
            "dataset": "order_items_dataset",
            "calculation_method": "sum",
            "folder": "Order_items",
            "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "food_revenue",
            "unique_name": "food_revenue",
            "object_type": "metric",
            "column": "FOOD_REVENUE",
            "dataset": "order_items_dataset",
            "calculation_method": "sum",
            "folder": "Order_items",
            "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "drink_revenue",
            "unique_name": "drink_revenue",
            "object_type": "metric",
            "column": "DRINK_REVENUE",
            "dataset": "order_items_dataset",
            "calculation_method": "sum",
            "folder": "Order_items",
            "description": "The revenue generated for each order item. Revenue is calculated as a sum of revenue associated with each product in an order.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "median_revenue",
            "unique_name": "median_revenue",
            "object_type": "metric",
            "column": "MEDIAN_REVENUE",
            "dataset": "order_items_dataset",
            "calculation_method": "average",
            "folder": "Order_items",
            "description": "The median revenue generated for each order item.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "count_lifetime_orders",
            "unique_name": "count_lifetime_orders",
            "object_type": "metric",
            "column": "COUNT_LIFETIME_ORDERS",
            "dataset": "customers_dataset",
            "calculation_method": "sum",
            "folder": "Customers",
            "description": "Total count of orders per customer.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "lifetime_spend_pretax",
            "unique_name": "lifetime_spend_pretax",
            "object_type": "metric",
            "column": "LIFETIME_SPEND_PRETAX",
            "dataset": "customers_dataset",
            "calculation_method": "sum",
            "folder": "Customers",
            "description": "Customer lifetime spend before taxes.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "lifetime_spend",
            "unique_name": "lifetime_spend",
            "object_type": "metric",
            "column": "LIFETIME_SPEND",
            "dataset": "customers_dataset",
            "calculation_method": "sum",
            "folder": "Customers",
            "description": "Gross customer lifetime spend inclusive of taxes.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "average_tax_rate",
            "unique_name": "average_tax_rate",
            "object_type": "metric",
            "column": "AVERAGE_TAX_RATE",
            "dataset": "stg_locations_dataset",
            "calculation_method": "average",
            "folder": "Stg_locations",
            "description": "Average tax rate.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "orders",
            "unique_name": "orders",
            "object_type": "metric",
            "column": "ORDER_COUNT",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "Count of orders.",
            "unrelated_dimensions_handling": "repeat"
        },
        {
            "label": "orders_fill_nulls_with_zero",
            "unique_name": "orders_fill_nulls_with_zero",
            "object_type": "metric",
            "column": "ORDER_COUNT",
            "dataset": "orders_dataset",
            "calculation_method": "sum",
            "folder": "Orders",
            "description": "Example metric colaescing null to zero.",
            "unrelated_dimensions_handling": "repeat"
        }
    ],
    "_measuresCalculated": [
        {
            "label": "twice_orders_fill_nulls_with_0",
            "unique_name": "twice_orders_fill_nulls_with_0",
            "object_type": "metric_calc",
            "expression": "2 * [Measures].[orders_fill_nulls_with_zero]",
            "folder": "Other Calculations",
            "description": "Example derived metric."
        },
        {
            "label": "orders_last_7_days",
            "unique_name": "orders_last_7_days",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[order_count]) THEN NULL ELSE Aggregate(PeriodsToDate([ordered_at Date Dimension].[ordered_at Date Week Hierarchy].[ordered_at YearWeek], [ordered_at Date Dimension].[ordered_at Date Week Hierarchy].CurrentMember), [Measures].[order_count]) END",
            "folder": "Orders",
            "description": "Count of orders."
        },
        {
            "label": "food_revenue_pct",
            "unique_name": "food_revenue_pct",
            "object_type": "metric_calc",
            "expression": "[Measures].[food_revenue] / [Measures].[revenue]",
            "folder": "Other Calculations",
            "description": "The % of order revenue from food."
        },
        {
            "label": "revenue_prev_month",
            "unique_name": "revenue_prev_month",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[revenue]) THEN NULL ELSE (ParallelPeriod([ordered_at Date Dimension].[ordered_at Date Month Hierarchy].[ordered_at Month1], 1, [ordered_at Date Dimension].[ordered_at Date Month Hierarchy].CurrentMember), [Measures].[revenue]) END",
            "folder": "Order_items",
            "description": "Calculation created from parent metric 'revenue_growth_mom'"
        },
        {
            "label": "revenue_growth_mom",
            "unique_name": "revenue_growth_mom",
            "object_type": "metric_calc",
            "expression": "([Measures].[revenue] - [Measures].[revenue_prev_month])*100/[Measures].[revenue_prev_month]",
            "folder": "Other Calculations",
            "description": "Percentage growth of revenue compared to 1 month ago. Excluded tax"
        },
        {
            "label": "order_gross_profit",
            "unique_name": "order_gross_profit",
            "object_type": "metric_calc",
            "expression": "[Measures].[revenue] - [Measures].[order_cost]",
            "folder": "Other Calculations",
            "description": "Gross profit from each order."
        },
        {
            "label": "cumulative_revenue",
            "unique_name": "cumulative_revenue",
            "object_type": "metric_calc",
            "expression": "CASE WHEN ISEMPTY([Measures].[revenue]) THEN NULL ELSE Aggregate(PeriodsToDate([ordered_at Date Dimension].[ordered_at Date Week Hierarchy].[ordered_at YearWeek], [ordered_at Date Dimension].[ordered_at Date Week Hierarchy].CurrentMember), [Measures].[revenue]) END",
            "folder": "Order_items",
            "description": "The cumulative revenue for all orders."
        }
    ],
    "_catalog": {
        "as_version": 1,
        "label": "jaffle_shop",
        "object_type": "catalog",
        "unique_name": "jaffle_shop.catalog",
        "aggressive_agg_promotion": false,
        "build_speculative_aggs": false
    }
}